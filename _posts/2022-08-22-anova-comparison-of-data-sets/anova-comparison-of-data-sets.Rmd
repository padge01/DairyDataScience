---
title: "Anova comparison of datasets"
description: |
  A short description of the post.
author:
  - name: Padraig Lucey
    url: https://www.linkedin.com/in/p%C3%A1draig-lucey-687506124/
date: 2022-08-22
draft: true
output:
  distill::distill_article:
    self_contained: false
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set("G:/OneDrive - University of California, Davis/PhD/proj1/r files/csv data sets/feedefficiency")
#knitr::opts_knit$set("~/Documents/GitHub/proj1/r files/csv data sets/feedefficiency")
```

## ANOVA comparison of all datasets

We are assessing the comparability of cows across all provided data-sets for inclusion in a compiled data-set. A data-set of all cows in all datasets will be used to draw random samplings of cows that represent pens on a dairy. These simulated pens will be used to fit the distribution of Dry Matter Intake (DMI) and other group level parameters will train a model that predict this distribution function. Before we can combine these data-sets together it is important to validate that the cows across the different data-sets are comparable metabolically, so that the assessment of DMI and the plotting of DMI distribution across the constructed pen groups is appropriate.

ANOVA compares two or more groups for a difference in group means. This is performed by comparing the variance between groups against the variance within each group. If the variance between groups is significantly larger than the variance within each group then the groups are considered significantly different.

The means of the values for milk production (kg), DMI (kg) and feed efficiency (fat corrected milk(FCM) (kg)/DMI (kg)) by data-set will be compared using ANOVA statistical analysis. Pairwise comparison of the group means, and visual assessment of the marginal values of each of these three outcomes will be used to assess the comparability of the data-sets and guide decision criteria for inclusion in a collated data-set.

## Data description 
### Number of cows in all data-sets
Table 1.
```{r summary, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(ggplot2)
library(flextable)
library(pander)
library(parameters)
library(reshape)
library(RColorBrewer)
library(kableExtra)
library(broom)
load("G:/OneDrive - University of California, Davis/PhD/proj1/r files/csv data sets/feedefficiency/alldata.rda")
#alldata %>%  
 # group_by(datasetcode) %>%
  # summarise(n=n()) %>% 
   # t() %>% 
    #  as.data.frame() %>% 
     # janitor::row_to_names(row_number = 1) %>% 
      #  row.names() %>%  c("Data set", "Number of Cows") %>% 
       # mutate(Total = rowSums(.1[1:5])) %>% 
        #flextable::flextable()
#class()
a <- alldata %>%  
  group_by(datasetcode) %>%
   summarise(n=n()) %>% 
    t() %>% 
  as.data.frame()%>% 
      janitor::row_to_names(row_number = 1)

row.names(a) <-   c("Number of Cows") 
#class(a)        
#sapply(a, class)
#class(a)

# Syntax
a$'1' = as.numeric(as.character(a$'1')) 
a$'2' = as.numeric(as.character(a$'2')) 
a$'3' = as.numeric(as.character(a$'3')) 
a$'4' = as.numeric(as.character(a$'4')) 
a$'5' = as.numeric(as.character(a$'5')) 
a$'6' = as.numeric(as.character(a$'6')) 
a$'7' = as.numeric(as.character(a$'7')) 
a$'8' = as.numeric(as.character(a$'8')) 
a$'9' = as.numeric(as.character(a$'9')) 

a <- a %>%  mutate(Total=sum(c_across(where(is.numeric))))
flextable::flextable(a %>% rownames_to_column("Data-set"))


alldata$datasetcode <- as.factor(alldata$datasetcode)
#class(alldata$datasetcode)

```


### Milk production
This plot demonstrates how milk production (kg) changes by week across the lactation for all cows in each data-set.
Figure 1.
```{r, echo=FALSE, warning=FALSE, message=FALSE}

#display.brewer.all(colorblindFriendly=TRUE)
malldata <- alldata %>% dplyr::select(datasetcode, 8:51) %>% 
  melt(id="datasetcode")
ggplot(malldata) + aes(x=variable, y=value, color=datasetcode) +
  geom_jitter(size=1.1) +
  labs(x="Week in Milk (0 - 44)", y="Kg Milk") + 
  theme(axis.text.x=element_blank()) +
  scale_color_brewer(palette= "Paired", name="Data-set")

```

### Dry matter intake
This plot demonstrates how DMI (kg) changes by week across the lactation for all cows in each data-set.
Figure 2.
```{r, echo=FALSE, warning=FALSE, message=FALSE}
dalldata <- alldata %>% dplyr::select(datasetcode, 96:139) %>% 
  melt(id="datasetcode")
ggplot(dalldata) + aes(x=variable, y=value, color=datasetcode) +
  geom_jitter(size=1.1) +
  labs(x="Week in Milk (0 - 44)", y="Kg DMI") + 
  theme(axis.text.x=element_blank()) +
  scale_color_brewer(palette= "Paired", name="Data-set")

```

### Feed Efficiency
This plot demonstrates how Feed Efficiency (kg fat corrected milk/kg DMI)) changes by week across the lactation for all cows in each data-set. 
Figure 3.
```{r, echo=FALSE, warning=FALSE, message=FALSE}
falldata <- alldata %>% dplyr::select(datasetcode, 140:183) %>% 
  melt(id="datasetcode")
ggplot(falldata) + aes(x=variable, y=value, color=datasetcode) +
  geom_jitter(size=1.1) +
  labs(x="Week in Milk (0 - 44)", y="Kg DMI") + 
  theme(axis.text.x=element_blank()) +
  scale_color_brewer(palette= "Paired", name="Data-set")

```


### Box-plots of milk yield (kg) by week for each data-set {.tabset}
Figure-set 4.  

#### Week 1
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk1) %>% as.data.frame %>%  flextable()
#ggplot(alldata) +
 # aes(x=CowID, y=milk1, color=datasetcode) +
  #geom_jitter() + geom_boxplot() + xlim(0, 5000) + ylab("Milk (kg)")+ 
  #scale_colour_discrete("Data-set")

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk1, na.rm=TRUE),
    Median=median(milk1, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk1, na.rm=TRUE),
    Maximum=max(milk1, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()


ggplot(alldata) +
  aes(x=datasetcode, y=milk1, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) +
  xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") +
  theme(legend.position="none")

```

#### Week 2
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk2)
group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk2, na.rm=TRUE),
    Median=median(milk2, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk2, na.rm=TRUE),
    Maximum=max(milk2, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk2, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 3
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk3)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk3, na.rm=TRUE),
    Median=median(milk3, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk3, na.rm=TRUE),
    Maximum=max(milk3, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk3, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 4
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk4)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk4, na.rm=TRUE),
    Median=median(milk4, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk4, na.rm=TRUE),
    Maximum=max(milk4, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk4, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 5
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk5)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk5, na.rm=TRUE),
    Median=median(milk5, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk5, na.rm=TRUE),
    Maximum=max(milk5, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk5, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 6
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk6)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk6, na.rm=TRUE),
    Median=median(milk6, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk6, na.rm=TRUE),
    Maximum=max(milk6, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk6, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 7
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk7)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk7, na.rm=TRUE),
    Median=median(milk7, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk7, na.rm=TRUE),
    Maximum=max(milk7, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk7, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 8
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk8)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk8, na.rm=TRUE),
    Median=median(milk8, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk8, na.rm=TRUE),
    Maximum=max(milk8, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk8, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 9
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk9)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk9, na.rm=TRUE),
    Median=median(milk9, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk9, na.rm=TRUE),
    Maximum=max(milk9, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk9, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 10
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk10)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk10, na.rm=TRUE),
    Median=median(milk10, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk10, na.rm=TRUE),
    Maximum=max(milk10, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk10, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 11
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk11)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk11, na.rm=TRUE),
    Median=median(milk11, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk11, na.rm=TRUE),
    Maximum=max(milk11, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk11, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 12
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk12)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk12, na.rm=TRUE),
    Median=median(milk12, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk12, na.rm=TRUE),
    Maximum=max(milk12, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk12, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 13
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk13)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk13, na.rm=TRUE),
    Median=median(milk13, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk13, na.rm=TRUE),
    Maximum=max(milk13, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk13, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 14
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk14)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk14, na.rm=TRUE),
    Median=median(milk14, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk14, na.rm=TRUE),
    Maximum=max(milk14, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk14, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 15
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk15)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk15, na.rm=TRUE),
    Median=median(milk15, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk15, na.rm=TRUE),
    Maximum=max(milk15, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk15, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 16
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk16)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk16, na.rm=TRUE),
    Median=median(milk16, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk16, na.rm=TRUE),
    Maximum=max(milk16, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk16, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 17
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk17)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk17, na.rm=TRUE),
    Median=median(milk17, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk17, na.rm=TRUE),
    Maximum=max(milk17, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk17, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 18
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk18)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk18, na.rm=TRUE),
    Median=median(milk18, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk18, na.rm=TRUE),
    Maximum=max(milk18, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()


ggplot(alldata) +
  aes(x=datasetcode, y=milk18, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 19
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk19)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk19, na.rm=TRUE),
    Median=median(milk19, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk19, na.rm=TRUE),
    Maximum=max(milk19, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk19, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 20
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk20)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk20, na.rm=TRUE),
    Median=median(milk20, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk20, na.rm=TRUE),
    Maximum=max(milk20, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()


ggplot(alldata) +
  aes(x=datasetcode, y=milk20, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 21
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk22)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk21, na.rm=TRUE),
    Median=median(milk21, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk21, na.rm=TRUE),
    Maximum=max(milk21, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk22, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 22
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk22)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk22, na.rm=TRUE),
    Median=median(milk22, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk22, na.rm=TRUE),
    Maximum=max(milk22, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk22, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 23
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk23)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk23, na.rm=TRUE),
    Median=median(milk23, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk23, na.rm=TRUE),
    Maximum=max(milk23, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk23, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 24
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk24)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk24, na.rm=TRUE),
    Median=median(milk24, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk24, na.rm=TRUE),
    Maximum=max(milk24, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk24, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 25
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk25)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk25, na.rm=TRUE),
    Median=median(milk25, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk25, na.rm=TRUE),
    Maximum=max(milk25, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk25, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 26
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk26)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk26, na.rm=TRUE),
    Median=median(milk26, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk26, na.rm=TRUE),
    Maximum=max(milk26, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk26, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 27
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk27)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk27, na.rm=TRUE),
    Median=median(milk27, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk27, na.rm=TRUE),
    Maximum=max(milk27, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk27, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 28
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk28)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk28, na.rm=TRUE),
    Median=median(milk28, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk28, na.rm=TRUE),
    Maximum=max(milk28, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk28, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 29
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk29)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk29, na.rm=TRUE),
    Median=median(milk29, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk29, na.rm=TRUE),
    Maximum=max(milk29, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk29, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 30
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk30)
ggplot(alldata) +
  aes(x=datasetcode, y=milk30, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 31
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk31)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk31, na.rm=TRUE),
    Median=median(milk31, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk31, na.rm=TRUE),
    Maximum=max(milk31, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk31, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 32
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk32)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk32, na.rm=TRUE),
    Median=median(milk32, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk32, na.rm=TRUE),
    Maximum=max(milk32, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk32, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 33
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk33)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk33, na.rm=TRUE),
    Median=median(milk33, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk33, na.rm=TRUE),
    Maximum=max(milk33, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk33, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 34
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk34)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk34, na.rm=TRUE),
    Median=median(milk34, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk34, na.rm=TRUE),
    Maximum=max(milk34, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()


ggplot(alldata) +
  aes(x=datasetcode, y=milk34, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 35
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk35)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk35, na.rm=TRUE),
    Median=median(milk35, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk35, na.rm=TRUE),
    Maximum=max(milk35, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk35, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 36
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk36)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk36, na.rm=TRUE),
    Median=median(milk36, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk36, na.rm=TRUE),
    Maximum=max(milk36, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk36, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 37
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk37)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk37, na.rm=TRUE),
    Median=median(milk37, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk37, na.rm=TRUE),
    Maximum=max(milk37, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk37, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 38
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk38)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk38, na.rm=TRUE),
    Median=median(milk38, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk38, na.rm=TRUE),
    Maximum=max(milk38, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk38, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 39
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk39)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk39, na.rm=TRUE),
    Median=median(milk39, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk39, na.rm=TRUE),
    Maximum=max(milk39, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk39, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 40
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk40)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk40, na.rm=TRUE),
    Median=median(milk40, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk40, na.rm=TRUE),
    Maximum=max(milk40, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk40, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 41
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk41)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk41, na.rm=TRUE),
    Median=median(milk41, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk41, na.rm=TRUE),
    Maximum=max(milk41, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk41, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 42
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk42)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk42, na.rm=TRUE),
    Median=median(milk42, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk42, na.rm=TRUE),
    Maximum=max(milk42, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk42, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 43
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk43)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk43, na.rm=TRUE),
    Median=median(milk43, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk43, na.rm=TRUE),
    Maximum=max(milk43, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk43, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 44
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$milk44)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(milk44, na.rm=TRUE),
    Median=median(milk44, na.rm=TRUE),
    "Standard Deviation"=sd(milk1, na.rm=TRUE),
    Minimum=min(milk44, na.rm=TRUE),
    Maximum=max(milk44, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=milk44, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Milk (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```



### Box-plots of DMI (kg) by week for each data-set {.tabset}
Figure-set 5.  

#### Week 1
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi1) %>% as.data.frame %>%  flextable()
#ggplot(alldata) +
 # aes(x=CowID, y=dmi1, color=datasetcode) +
  #geom_jitter() + geom_boxplot() + xlim(0, 5000) + ylab("DMI (kg)")+ 
  #scale_colour_discrete("Data-set")

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi1, na.rm=TRUE),
    Median=median(dmi1, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi1, na.rm=TRUE),
    Maximum=max(dmi1, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()


ggplot(alldata) +
  aes(x=datasetcode, y=dmi1, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) +
  xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") +
  theme(legend.position="none")

```

#### Week 2
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi2)
group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi2, na.rm=TRUE),
    Median=median(dmi2, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi2, na.rm=TRUE),
    Maximum=max(dmi2, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi2, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 3
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi3)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi3, na.rm=TRUE),
    Median=median(dmi3, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi3, na.rm=TRUE),
    Maximum=max(dmi3, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi3, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 4
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi4)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi4, na.rm=TRUE),
    Median=median(dmi4, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi4, na.rm=TRUE),
    Maximum=max(dmi4, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi4, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 5
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi5)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi5, na.rm=TRUE),
    Median=median(dmi5, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi5, na.rm=TRUE),
    Maximum=max(dmi5, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi5, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 6
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi6)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi6, na.rm=TRUE),
    Median=median(dmi6, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi6, na.rm=TRUE),
    Maximum=max(dmi6, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi6, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 7
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi7)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi7, na.rm=TRUE),
    Median=median(dmi7, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi7, na.rm=TRUE),
    Maximum=max(dmi7, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi7, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 8
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi8)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi8, na.rm=TRUE),
    Median=median(dmi8, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi8, na.rm=TRUE),
    Maximum=max(dmi8, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi8, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 9
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi9)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi9, na.rm=TRUE),
    Median=median(dmi9, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi9, na.rm=TRUE),
    Maximum=max(dmi9, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi9, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 10
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi10)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi10, na.rm=TRUE),
    Median=median(dmi10, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi10, na.rm=TRUE),
    Maximum=max(dmi10, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi10, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 11
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi11)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi11, na.rm=TRUE),
    Median=median(dmi11, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi11, na.rm=TRUE),
    Maximum=max(dmi11, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi11, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 12
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi12)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi12, na.rm=TRUE),
    Median=median(dmi12, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi12, na.rm=TRUE),
    Maximum=max(dmi12, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi12, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 13
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi13)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi13, na.rm=TRUE),
    Median=median(dmi13, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi13, na.rm=TRUE),
    Maximum=max(dmi13, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi13, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 14
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi14)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi14, na.rm=TRUE),
    Median=median(dmi14, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi14, na.rm=TRUE),
    Maximum=max(dmi14, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi14, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 15
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi15)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi15, na.rm=TRUE),
    Median=median(dmi15, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi15, na.rm=TRUE),
    Maximum=max(dmi15, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi15, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 16
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi16)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi16, na.rm=TRUE),
    Median=median(dmi16, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi16, na.rm=TRUE),
    Maximum=max(dmi16, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi16, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 17
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi17)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi17, na.rm=TRUE),
    Median=median(dmi17, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi17, na.rm=TRUE),
    Maximum=max(dmi17, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi17, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 18
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi18)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi18, na.rm=TRUE),
    Median=median(dmi18, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi18, na.rm=TRUE),
    Maximum=max(dmi18, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()


ggplot(alldata) +
  aes(x=datasetcode, y=dmi18, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 19
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi19)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi19, na.rm=TRUE),
    Median=median(dmi19, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi19, na.rm=TRUE),
    Maximum=max(dmi19, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi19, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 20
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi20)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi20, na.rm=TRUE),
    Median=median(dmi20, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi20, na.rm=TRUE),
    Maximum=max(dmi20, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()


ggplot(alldata) +
  aes(x=datasetcode, y=dmi20, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 21
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi22)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi21, na.rm=TRUE),
    Median=median(dmi21, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi21, na.rm=TRUE),
    Maximum=max(dmi21, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi22, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 22
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi22)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi22, na.rm=TRUE),
    Median=median(dmi22, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi22, na.rm=TRUE),
    Maximum=max(dmi22, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi22, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 23
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi23)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi23, na.rm=TRUE),
    Median=median(dmi23, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi23, na.rm=TRUE),
    Maximum=max(dmi23, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi23, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 24
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi24)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi24, na.rm=TRUE),
    Median=median(dmi24, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi24, na.rm=TRUE),
    Maximum=max(dmi24, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi24, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 25
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi25)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi25, na.rm=TRUE),
    Median=median(dmi25, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi25, na.rm=TRUE),
    Maximum=max(dmi25, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi25, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 26
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi26)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi26, na.rm=TRUE),
    Median=median(dmi26, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi26, na.rm=TRUE),
    Maximum=max(dmi26, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi26, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 27
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi27)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi27, na.rm=TRUE),
    Median=median(dmi27, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi27, na.rm=TRUE),
    Maximum=max(dmi27, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi27, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 28
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi28)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi28, na.rm=TRUE),
    Median=median(dmi28, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi28, na.rm=TRUE),
    Maximum=max(dmi28, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi28, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 29
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi29)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi29, na.rm=TRUE),
    Median=median(dmi29, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi29, na.rm=TRUE),
    Maximum=max(dmi29, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi29, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 30
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi30)
ggplot(alldata) +
  aes(x=datasetcode, y=dmi30, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 31
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi31)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi31, na.rm=TRUE),
    Median=median(dmi31, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi31, na.rm=TRUE),
    Maximum=max(dmi31, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi31, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 32
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi32)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi32, na.rm=TRUE),
    Median=median(dmi32, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi32, na.rm=TRUE),
    Maximum=max(dmi32, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi32, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 33
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi33)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi33, na.rm=TRUE),
    Median=median(dmi33, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi33, na.rm=TRUE),
    Maximum=max(dmi33, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi33, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 34
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi34)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi34, na.rm=TRUE),
    Median=median(dmi34, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi34, na.rm=TRUE),
    Maximum=max(dmi34, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()


ggplot(alldata) +
  aes(x=datasetcode, y=dmi34, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 35
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi35)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi35, na.rm=TRUE),
    Median=median(dmi35, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi35, na.rm=TRUE),
    Maximum=max(dmi35, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi35, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 36
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi36)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi36, na.rm=TRUE),
    Median=median(dmi36, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi36, na.rm=TRUE),
    Maximum=max(dmi36, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi36, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 37
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi37)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi37, na.rm=TRUE),
    Median=median(dmi37, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi37, na.rm=TRUE),
    Maximum=max(dmi37, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi37, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 38
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi38)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi38, na.rm=TRUE),
    Median=median(dmi38, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi38, na.rm=TRUE),
    Maximum=max(dmi38, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi38, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 39
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi39)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi39, na.rm=TRUE),
    Median=median(dmi39, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi39, na.rm=TRUE),
    Maximum=max(dmi39, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi39, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 40
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi40)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi40, na.rm=TRUE),
    Median=median(dmi40, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi40, na.rm=TRUE),
    Maximum=max(dmi40, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi40, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 41
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi41)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi41, na.rm=TRUE),
    Median=median(dmi41, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi41, na.rm=TRUE),
    Maximum=max(dmi41, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi41, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 42
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi42)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi42, na.rm=TRUE),
    Median=median(dmi42, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi42, na.rm=TRUE),
    Maximum=max(dmi42, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi42, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 43
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi43)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi43, na.rm=TRUE),
    Median=median(dmi43, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi43, na.rm=TRUE),
    Maximum=max(dmi43, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi43, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("DMI (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 44
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$dmi44)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(dmi44, na.rm=TRUE),
    Median=median(dmi44, na.rm=TRUE),
    "Standard Deviation"=sd(dmi1, na.rm=TRUE),
    Minimum=min(dmi44, na.rm=TRUE),
    Maximum=max(dmi44, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=dmi44, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("dmi (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```




### Box-plots of feed efficiency by week for each data-set {.tabset}
Figure-set 6.  

#### Week 1
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE1) %>% as.data.frame %>%  flextable()
#ggplot(alldata) +
 # aes(x=CowID, y=FE1, color=datasetcode) +
  #geom_jitter() + geom_boxplot() + xlim(0, 5000) + ylab("FE (kg)")+ 
  #scale_colour_discrete("Data-set")

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE1, na.rm=TRUE),
    Median=median(FE1, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE1, na.rm=TRUE),
    Maximum=max(FE1, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()


ggplot(alldata) +
  aes(x=datasetcode, y=FE1, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) +
  xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") +
  theme(legend.position="none")

```

#### Week 2
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE2)
group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE2, na.rm=TRUE),
    Median=median(FE2, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE2, na.rm=TRUE),
    Maximum=max(FE2, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE2, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 3
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE3)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE3, na.rm=TRUE),
    Median=median(FE3, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE3, na.rm=TRUE),
    Maximum=max(FE3, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE3, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 4
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE4)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE4, na.rm=TRUE),
    Median=median(FE4, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE4, na.rm=TRUE),
    Maximum=max(FE4, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE4, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 5
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE5)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE5, na.rm=TRUE),
    Median=median(FE5, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE5, na.rm=TRUE),
    Maximum=max(FE5, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE5, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 6
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE6)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE6, na.rm=TRUE),
    Median=median(FE6, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE6, na.rm=TRUE),
    Maximum=max(FE6, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE6, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 7
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE7)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE7, na.rm=TRUE),
    Median=median(FE7, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE7, na.rm=TRUE),
    Maximum=max(FE7, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE7, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 8
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE8)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE8, na.rm=TRUE),
    Median=median(FE8, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE8, na.rm=TRUE),
    Maximum=max(FE8, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE8, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 9
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE9)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE9, na.rm=TRUE),
    Median=median(FE9, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE9, na.rm=TRUE),
    Maximum=max(FE9, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE9, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 10
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE10)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE10, na.rm=TRUE),
    Median=median(FE10, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE10, na.rm=TRUE),
    Maximum=max(FE10, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE10, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 11
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE11)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE11, na.rm=TRUE),
    Median=median(FE11, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE11, na.rm=TRUE),
    Maximum=max(FE11, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE11, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 12
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE12)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE12, na.rm=TRUE),
    Median=median(FE12, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE12, na.rm=TRUE),
    Maximum=max(FE12, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE12, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 13
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE13)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE13, na.rm=TRUE),
    Median=median(FE13, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE13, na.rm=TRUE),
    Maximum=max(FE13, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE13, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 14
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE14)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE14, na.rm=TRUE),
    Median=median(FE14, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE14, na.rm=TRUE),
    Maximum=max(FE14, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE14, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 15
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE15)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE15, na.rm=TRUE),
    Median=median(FE15, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE15, na.rm=TRUE),
    Maximum=max(FE15, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE15, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 16
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE16)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE16, na.rm=TRUE),
    Median=median(FE16, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE16, na.rm=TRUE),
    Maximum=max(FE16, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE16, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 17
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE17)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE17, na.rm=TRUE),
    Median=median(FE17, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE17, na.rm=TRUE),
    Maximum=max(FE17, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE17, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 18
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE18)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE18, na.rm=TRUE),
    Median=median(FE18, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE18, na.rm=TRUE),
    Maximum=max(FE18, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()


ggplot(alldata) +
  aes(x=datasetcode, y=FE18, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 19
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE19)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE19, na.rm=TRUE),
    Median=median(FE19, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE19, na.rm=TRUE),
    Maximum=max(FE19, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE19, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 20
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE20)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE20, na.rm=TRUE),
    Median=median(FE20, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE20, na.rm=TRUE),
    Maximum=max(FE20, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()


ggplot(alldata) +
  aes(x=datasetcode, y=FE20, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 21
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE22)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE21, na.rm=TRUE),
    Median=median(FE21, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE21, na.rm=TRUE),
    Maximum=max(FE21, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE22, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 22
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE22)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE22, na.rm=TRUE),
    Median=median(FE22, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE22, na.rm=TRUE),
    Maximum=max(FE22, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE22, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 23
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE23)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE23, na.rm=TRUE),
    Median=median(FE23, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE23, na.rm=TRUE),
    Maximum=max(FE23, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE23, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 24
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE24)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE24, na.rm=TRUE),
    Median=median(FE24, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE24, na.rm=TRUE),
    Maximum=max(FE24, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE24, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 25
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE25)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE25, na.rm=TRUE),
    Median=median(FE25, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE25, na.rm=TRUE),
    Maximum=max(FE25, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE25, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 26
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE26)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE26, na.rm=TRUE),
    Median=median(FE26, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE26, na.rm=TRUE),
    Maximum=max(FE26, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE26, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 27
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE27)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE27, na.rm=TRUE),
    Median=median(FE27, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE27, na.rm=TRUE),
    Maximum=max(FE27, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE27, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 28
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE28)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE28, na.rm=TRUE),
    Median=median(FE28, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE28, na.rm=TRUE),
    Maximum=max(FE28, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE28, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 29
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE29)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE29, na.rm=TRUE),
    Median=median(FE29, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE29, na.rm=TRUE),
    Maximum=max(FE29, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE29, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 30
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE30)
ggplot(alldata) +
  aes(x=datasetcode, y=FE30, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 31
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE31)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE31, na.rm=TRUE),
    Median=median(FE31, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE31, na.rm=TRUE),
    Maximum=max(FE31, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE31, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 32
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE32)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE32, na.rm=TRUE),
    Median=median(FE32, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE32, na.rm=TRUE),
    Maximum=max(FE32, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE32, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 33
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE33)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE33, na.rm=TRUE),
    Median=median(FE33, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE33, na.rm=TRUE),
    Maximum=max(FE33, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE33, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 34
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE34)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE34, na.rm=TRUE),
    Median=median(FE34, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE34, na.rm=TRUE),
    Maximum=max(FE34, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()


ggplot(alldata) +
  aes(x=datasetcode, y=FE34, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 35
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE35)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE35, na.rm=TRUE),
    Median=median(FE35, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE35, na.rm=TRUE),
    Maximum=max(FE35, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE35, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 36
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE36)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE36, na.rm=TRUE),
    Median=median(FE36, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE36, na.rm=TRUE),
    Maximum=max(FE36, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE36, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 37
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE37)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE37, na.rm=TRUE),
    Median=median(FE37, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE37, na.rm=TRUE),
    Maximum=max(FE37, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE37, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 38
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE38)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE38, na.rm=TRUE),
    Median=median(FE38, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE38, na.rm=TRUE),
    Maximum=max(FE38, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE38, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 39
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE39)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE39, na.rm=TRUE),
    Median=median(FE39, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE39, na.rm=TRUE),
    Maximum=max(FE39, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE39, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 40
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE40)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE40, na.rm=TRUE),
    Median=median(FE40, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE40, na.rm=TRUE),
    Maximum=max(FE40, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE40, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 41
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE41)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE41, na.rm=TRUE),
    Median=median(FE41, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE41, na.rm=TRUE),
    Maximum=max(FE41, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE41, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 42
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE42)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE42, na.rm=TRUE),
    Median=median(FE42, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE42, na.rm=TRUE),
    Maximum=max(FE42, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE42, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 43
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE43)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE43, na.rm=TRUE),
    Median=median(FE43, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE43, na.rm=TRUE),
    Maximum=max(FE43, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE43, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```

#### Week 44
```{r , echo=FALSE, warning=FALSE, comment=""}
#summary(alldata$FE44)

group_by(alldata, datasetcode) %>% 
  summarise(
    Mean=mean(FE44, na.rm=TRUE),
    Median=median(FE44, na.rm=TRUE),
    "Standard Deviation"=sd(FE1, na.rm=TRUE),
    Minimum=min(FE44, na.rm=TRUE),
    Maximum=max(FE44, na.rm=TRUE))%>% 
  t() %>% as.data.frame() %>% 
  janitor::row_to_names(row_number = 1) %>% 
  rownames_to_column("Data-set") %>% 
  flextable::flextable()

ggplot(alldata) +
  aes(x=datasetcode, y=FE44, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("FE (kg)") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")

```



## Hypothesis
>$H_0:$ the data-sets are equal in 1. milk production (kg), 2. DMI (kg), 3. feed efficiency  
>$H_1:$ at least one mean is different between all data-sets

## ANOVA methods
### Assumptions
#### Variable type
Milk production (kg), DMI (kg) and feed efficiency (ratio) are all considered continuous variables. Groups to compare are data-set of cow origin which is a qualitative variable.  

#### Independence
Between group observations are independent as data was collected from separate trials and sites by data-set.
Within group observations are assumed independent as observations are on the level of cow with one measurement per time-point per cow and assumed no behavior interaction between cows as feed data was collected via individual feed bunks (Calan gates).  

#### Normality 
Residuals will be assessed for normal distribution. Each group sample size is $n > 30$.  

#### Equality of variance
Group variance differs (a significant levene test indicates unequal variance), but since data-set sample sizes are similar (Table 1) it is assumed that the ANOVA test is robust enough to accept this violation of the assumption. (Or use the Welch ANOVA which does not require this assumption).  

```{r, include=FALSE}
library(car)
# variance is equal if the test is not significant
  leveneTest(alldata$milk1, alldata$datasetcode)
```
#### Outliers
Outliers were assessed by box-plot descriptive analysis (Figure-set 4, 5, 6). No outliers were detected in milk production (kg) or DMI (kg).  
In the feed efficiency variable an outlier of 9.18 was observed at week 35 for data-set 8. 
```{r, echo=FALSE, warning=FALSE, message=FALSE}
outlier <-  alldata %>% filter(FE35 >4) %>% 
  dplyr::select(CowID, milk35, fatmilk35, dmi35, FE35, datasetcode) %>% 
  as.data.frame() 
#outlier <- as_tibble(outlier)
colnames(outlier)[2] ="Milk (kg)"
colnames(outlier)[3] ="FCM (kg)"
colnames(outlier)[4] ="DMI (kg)"
colnames(outlier)[5] ="FE"
colnames(outlier)[6] ="Data-set"

#rename(outlier, "Milk (kg)" = milk35, "FCM (kg)"=fatmilk35, "DMI (kg)"=dmi35, "FE"=FE35, "Data-set"=datasetcode)
outlier %>% flextable::flextable()
                                
```
This cow was traced back to the original database of that trial and a value of 10.9 was input as the milk fat yield (kg) at week 35. This is a biological impossibility and a data entry error so the feed efficiency value for this record at week 35 was removed from the ANOVA analysis. 

##### Updated box-plot of week 35 feed efficiency
```{r, echo=FALSE, comment="", warning=FALSE, message=FALSE}
alldata.1 <- alldata
alldata.1$FE35[alldata$CowID == 595] <- NA
alldata.1$datasetcode <- as.factor(alldata.1$datasetcode)
#class(alldata.1$datasetcode)
pander(summary(alldata.1$FE35))
ggplot(alldata.1) +
  aes(x=datasetcode, y=FE35, fill=datasetcode) +
  geom_boxplot(alpha=0.6) + geom_point(alpha=0.2) + xlab("Data-set") + ylab("Feed Efficiency") + 
  scale_fill_brewer(palette="Paired") + theme(legend.position="none")
```

### Model equation

$$Y_{i,j} =  + \beta_i+_{i,j}$$ 

$Y_{i,j}$ is the $j$-th observation $(j = 1, 2, ..., n_i$) of the $i$-th group ($i = 1, 2, ..., 9$ levels).\
$$ is the common effect for the whole experiment.\
$\beta_i$ is the $i$-th treatment effect.\
$_{i,j}$ is the random error present in the $j$-th observation on the $i$-th treatment.

$\sum \beta_i = 0, i = 1, ..., 9$ are considered fixed parameters and this is a fixed effects model. 


### Model fitting for milk (kg) as output variable {.tabset}

```{r, results='asis', echo=FALSE, warning=FALSE, message=FALSE}

z=0
for (i in alldata.1[,8:50]) {
  z <- z+1
  cat("\n")
  cat("#### Week ", z, "\n")
  model <- aov(i ~datasetcode, data=alldata.1) 
  model.output <- assign(paste0("aov", z), model,pos = 1) 
  print(print_html(model_parameters(model.output, summary=TRUE)))
  cat("  \n")
  cat("##### Testing model assumption of residual normality with QQ plot")
  plot(model.output, which =2)
  cat("  \n", report::report(model.output))
  cat("  \n", "Statistical significance (*P < 0.5*) means we reject the null hypothesis that the means are equal.")
  tukey <- tidy(TukeyHSD(model.output))
  tukey <- tukey %>% dplyr::select(-term, -null.value)
  print(kable(tukey, col.names=c("Contrast","Difference", "Lower CI", "Upper CI", "*P*-value")) %>% 
    kable_styling() %>% scroll_box(height = "500px"))
  cat("\n")
  print(plot(TukeyHSD(model.output)))
}

#class(alldata.1$datasetcode)
#x=0
#for (i in alldata.1[,8:10]) {
 # x <- x+1
  #cat("\n")
  #cat("#### Week ", x, "\n")
  #model <- aov(i ~datasetcode, data=alldata.1) 
  #model.output <- assign(paste0("aov", x), model,pos = 1) 
  #pander(summary(model.output))
  #print(report::report(model.output))
  #cat("\n")
  #cat("Statistical significance means we reject the null hypothesis that the means are equal \n")
#}

#for (i in alldata.1[,8:51]) {
  #milk.model <-  aov(i ~ datasetcode, data = alldata.1)
  #tkalldata <- TukeyHSD(milk.model)
  #cat("#### Week ", i, "\n")
  #print(summary(milk.model))
    #class(alldata.1$datasetcode)
#}
```


### Model fitting for DMI (kg) as output variable {.tabset}

```{r, results='asis', echo=FALSE, warning=FALSE, message=FALSE}

z=0
for (i in alldata.1[,96:138]) {
  z <- z+1
  cat("\n")
  cat("#### Week ", z, "\n")
  model <- aov(i ~datasetcode, data=alldata.1) 
  model.output <- assign(paste0("aov", z), model,pos = 1) 
  print(print_html(model_parameters(model.output, summary=TRUE)))
  cat("  \n")
  cat("##### Testing model assumption of residual normality with QQ plot")
  plot(model.output, which =2)
  cat("  \n", report::report(model.output))
  cat("  \n", "Statistical significance (*P < 0.5*) means we reject the null hypothesis that the means are equal.")
  tukey <- tidy(TukeyHSD(model.output))
  tukey <- tukey %>% dplyr::select(-term, -null.value)
  print(kable(tukey, col.names=c("Contrast","Difference", "Lower CI", "Upper CI", "*P*-value")) %>% 
    kable_styling() %>% scroll_box(height = "500px"))
  cat("\n")
  print(plot(TukeyHSD(model.output)))
}

```


### Model fitting for FE as output variable {.tabset}

```{r, results='asis', echo=FALSE, warning=FALSE, message=FALSE}

z=0
for (i in alldata.1[,140:182]) {
  z <- z+1
  cat("\n")
  cat("#### Week ", z, "\n")
  model <- aov(i ~datasetcode, data=alldata.1) 
  model.output <- assign(paste0("aov", z), model,pos = 1) 
  print(print_html(model_parameters(model.output, summary=TRUE)))
  cat("  \n")
  cat("##### Testing model assumption of residual normality with QQ plot")
  plot(model.output, which =2)
  cat("  \n", report::report(model.output))
  cat("  \n", "Statistical significance (*P < 0.5*) means we reject the null hypothesis that the means are equal.")
  tukey <- tidy(TukeyHSD(model.output))
  tukey <- tukey %>% dplyr::select(-term, -null.value)
  print(kable(tukey, col.names=c("Contrast","Difference", "Lower CI", "Upper CI", "*P*-value")) %>% 
    kable_styling() %>% scroll_box(height = "500px"))
  cat("\n")
  print(plot(TukeyHSD(model.output)))
}

```
